<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="2/15/2016 12:05:21 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="TB101541"
  DTS:CreatorName="CORP\tb101541"
  DTS:DelayValidation="True"
  DTS:DTSID="{7966EB73-B66F-44B9-8130-D35219864048}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="14.0.3002.68"
  DTS:LocaleID="1033"
  DTS:MaxConcurrentExecutables="100"
  DTS:ObjectName="DP_ODSLoad_Processes"
  DTS:PackageType="5"
  DTS:VersionBuild="586"
  DTS:VersionGUID="{EDCFB52A-9EBB-4128-9D54-04B5B44280B6}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[Target]"
      DTS:CreationName="OLEDB"
      DTS:DelayValidation="True"
      DTS:DTSID="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
      DTS:ObjectName="Target">
      <DTS:PropertyExpression
        DTS:Name="InitialCatalog">@[$Package::TargetDatabase]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="ServerName">@[$Package::TargetServer]</DTS:PropertyExpression>
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=DSQL112V\ANLITXETLDEV2;Initial Catalog=Wcsods;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:PackageParameters>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="3"
      DTS:DTSID="{A8BE69D9-D356-437A-B37A-C7B31B3ED1BF}"
      DTS:ObjectName="CoreDBVersionId">
      <DTS:Property
        DTS:DataType="3"
        DTS:Name="ParameterValue">0</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{B7A65A5C-0522-4E6C-BAAD-3D2DD005C0DB}"
      DTS:ObjectName="CustomerDatabase">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">ODS_dB_1_Child</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="3"
      DTS:DTSID="{81AC341D-5659-4712-ABBB-E1221006D1DD}"
      DTS:ObjectName="CustomerId">
      <DTS:Property
        DTS:DataType="3"
        DTS:Name="ParameterValue">1</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="3"
      DTS:DTSID="{63E70D16-0922-4962-B1C9-9B46F5FE3118}"
      DTS:ObjectName="DataExtractTypeId">
      <DTS:Property
        DTS:DataType="3"
        DTS:Name="ParameterValue">0</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{87F723FB-2B83-443B-9108-EF4CA947DE67}"
      DTS:ObjectName="DataRepositoryPath">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">\\MEDPD-DELL20\OdsFileExtractsDev\SmartAdvisor\</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{F3AD868F-2BD3-4A80-8F27-04BE27914A7F}"
      DTS:ObjectName="OdsVersion">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">1.0.0.0</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="3"
      DTS:DTSID="{B157B0A9-E107-4290-85A4-1B713A29E877}"
      DTS:ObjectName="OltpPostingGroupAudutId">
      <DTS:Property
        DTS:DataType="3"
        DTS:Name="ParameterValue">1</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{7BCDF2D3-A7B0-4BB7-9C34-435DA399ACE2}"
      DTS:ObjectName="SnapshotDate">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">1900-01-01 00:00:00.000</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{AFA4CAC9-00C8-4AC3-A617-53C88574491B}"
      DTS:ObjectName="TargetDatabase">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">Wcsods</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{90AC7048-F07A-4306-A474-712A68AFEF04}"
      DTS:ObjectName="TargetServer">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">DSQL112V\ANLITXETLDEV2</DTS:Property>
    </DTS:PackageParameter>
  </DTS:PackageParameters>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{7C0CE42A-A38B-4052-997E-E7AB30EBE354}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="FormatFileRepository">
      <DTS:VariableValue
        DTS:DataType="8">ODS_FormatFiles</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{0C2AFC8C-15E5-407C-BEAC-C2667E0342F2}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="LatestCoreDBVersionId">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{6297DA84-1C97-4F15-A6AD-4521D2AB8715}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="OdsPostingGroupAuditId">
      <DTS:VariableValue
        DTS:DataType="3">1</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{1A2AE644-4BA0-4172-8DFA-A9A9E86A259D}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="OdsPostingGroupId">
      <DTS:VariableValue
        DTS:DataType="3">1</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Process LoadGroup 1"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:DelayValidation="True"
      DTS:Description="Sequence Container"
      DTS:DTSID="{393F6ACE-4C7D-40D1-9F51-C8A0CC4F1E8D}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Process LoadGroup 1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{7F7FCABF-0B42-4D28-BED6-BE0C9126C866}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="DataFileList">
          <DTS:VariableValue
            DTS:DataSubType="ManagedSerializable"
            DTS:DataType="13">
            <SOAP-ENV:Envelope xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
              <SOAP-ENV:Body>
                <xsd:anyType
                  id="ref-1"></xsd:anyType>
              </SOAP-ENV:Body>
            </SOAP-ENV:Envelope>
          </DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{B8D9B263-3060-44FB-BF61-C3315F4CBF80}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="DataFileName">
          <DTS:VariableValue
            DTS:DataType="8">MMedical_Ameriprise_20160215012016_BILL_HDR.txt</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{8C9EFF93-B3C5-4489-BC2C-5A5B3145DFD3}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="FullLoadStatus">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{A4828476-8950-40DB-9D2E-D7BA10CDA433}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="IsSnapshot">
          <DTS:VariableValue
            DTS:DataType="11">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{9FB9D4B3-5F23-4FFB-8355-8BF120D050A3}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="LoadGroup">
          <DTS:VariableValue
            DTS:DataType="3">1</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{82BEDB3B-D35E-423C-863F-D8F552013DF9}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="OnError">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{1B56AB87-C3C5-4BBA-90B3-D8BF1C7A12F5}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="ProcessAuditId">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{538B985F-ABCD-475A-B258-04BFCAB73425}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="ProcessId">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{7356688B-91E0-4027-8C22-5AF137B4589B}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="ProductKey">
          <DTS:VariableValue
            DTS:DataType="8">SmartAdvisor</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{6CECA969-6ADE-468E-90A9-F4917861767F}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountControl">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{FD85783F-1EE6-4094-A5FD-FD4A9CC1A07B}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountExtract">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{66A85214-F588-4294-8F9B-10089C5E61FB}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountLoad">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{52B0E40C-0256-4238-9115-BBA9C1C59587}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="TargetTableName">
          <DTS:VariableValue
            DTS:DataType="8"
            xml:space="preserve"></DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{C0883290-433A-458D-8BF2-2763C38C8272}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="TotalRecordsInSource">
          <DTS:VariableValue
            DTS:DataType="20">0</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container"
          DTS:CreationName="STOCK:FOREACHLOOP"
          DTS:DelayValidation="True"
          DTS:Description="Foreach Loop Container"
          DTS:DTSID="{D2BEF613-D0B4-4EA3-A822-06AB7BDD34CD}"
          DTS:ExecutableType="STOCK:FOREACHLOOP"
          DTS:LocaleID="-1"
          DTS:MaxErrorCount="100"
          DTS:ObjectName="Foreach Table in PostingGroup Loop Container">
          <DTS:ForEachEnumerator
            DTS:CreationName="Microsoft.ForEachADOEnumerator"
            DTS:DTSID="{186133A6-265E-46C2-A15C-27A9C022387E}"
            DTS:ObjectName="{186133A6-265E-46C2-A15C-27A9C022387E}">
            <DTS:ObjectData>
              <FEEADO
                EnumType="EnumerateRowsInFirstTable"
                VarName="User::DataFileList" />
            </DTS:ObjectData>
          </DTS:ForEachEnumerator>
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="Disable">@[User::OdsPostingGroupAuditId] == 0 ? True: False</DTS:PropertyExpression>
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{59582E67-00DF-4139-A966-0B18B5735128}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="BulkInsertIntoStaging"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{008CA24A-000C-4B15-914A-F153E2286FBE}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{03C43AC1-63A8-4389-B9AF-928F394911C4}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{0D7D2B76-EBB4-47E7-B20E-10E2ADCEA1EB}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">(@[User::OnError] ==1)||(@[User::RowCountExtract]==-1 )? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                          SQLTask:SqlStatementSource="DECLARE @RowCount INT=?;&#xA;DECLARE @ProcessAuditId INT=?;&#xA;&#xA;UPDATE [adm].[ProcessAudit]&#xA;SET  [Status] = 'L'&#xA;&#x9;,[ExtractDate] = GETDATE()&#xA;&#x9;,[ExtractRowCount] = @RowCount &#xA;&#x9;,[LastChangeDate] = GETDATE()&#xA;WHERE [ProcessAuditId] = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::RowCountExtract"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]"
                  DTS:CreationName="OnPreExecute"
                  DTS:DTSID="{F16108F7-3C42-49E9-A8A1-6483A7859309}"
                  DTS:EventID="0"
                  DTS:EventName="OnPreExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{8B00CA3E-86E1-47C4-A854-E1A8E94285C2}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{4AC76055-EB17-452E-B30C-D188FFC3A75F}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Generate ProcessAuditId"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessId INT=?&#xA;  ,@ControlRowCount INT=?&#xA;  ,@CustomerId INT=?&#xA;  ,@IsSnapshot INT=?&#xA;  ,@PostingGroupAuditId INT=?&#xA;  ,@DataExtractTypeId INT=?&#xA;  ,@TotalRecordsInSource BIGINT=?;&#xA;&#xA;EXEC adm.Etl_GetProcessAuditId @ProcessId,@ControlRowCount,@TotalRecordsInSource,@CustomerId,@IsSnapshot,@PostingGroupAuditId,@DataExtractTypeId"
                          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId" />
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="1"
                            SQLTask:DtsVariableName="User::FullLoadStatus" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::RowCountControl"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="2"
                            SQLTask:DtsVariableName="$Package::CustomerId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="3"
                            SQLTask:DtsVariableName="User::IsSnapshot"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="4"
                            SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="5"
                            SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="6"
                            SQLTask:DtsVariableName="User::TotalRecordsInSource"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{86BDA642-697E-49E9-8372-846571BE090D}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Error Variable">
                      <DTS:Variables />
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                          SQLTask:SqlStatementSource="SELECT 0 AS OnError"
                          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="0"
                            SQLTask:DtsVariableName="User::OnError" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                  <DTS:PrecedenceConstraints>
                    <DTS:PrecedenceConstraint
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint]"
                      DTS:CreationName=""
                      DTS:DTSID="{8945F086-DDE3-41DF-8033-FD33CC3A1807}"
                      DTS:From="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
                      DTS:LogicalAnd="True"
                      DTS:ObjectName="Constraint"
                      DTS:To="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId" />
                  </DTS:PrecedenceConstraints>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                  SQLTask:SqlStatementSource="DECLARE  @DataFileRepository VARCHAR(255) = ?&#xA;&#x9;&#x9;,@FormatFileRepository VARCHAR(255) = ?&#xA;&#x9;&#x9;,@DataFileName VARCHAR(255) = ?&#xA;&#x9;&#x9;,@CustomerDatabase VARCHAR(100) = ?&#xA;&#x9;&#x9;,@TargetTableName VARCHAR(255) = ?&#xA;&#x9;&#x9;,@OdsVersion VARCHAR(20) = ?&#xA;&#x9;&#x9;,@DataExtractTypeId INT=?&#xA;&#x9;&#x9;,@FullLoadStatus INT=?&#xA;&#x9;&#x9;,@CoreDBVersionId INT=?&#xA;&#x9;&#x9;,@LatestCoreDBVersionId INT=?&#xA;&#x9;&#x9;,@IsSnapshot INT=?&#xA;&#x9;&#x9;,@ProductKey VARCHAR(100)=?&#xA;&#x9;&#x9;,@SQLQuery VARCHAR(MAX);&#xA;&#xA;-- Truncate Staging table and drop any indexes that exist.&#xA;SET @SQLQuery=&#xA;'TRUNCATE TABLE stg.'+@TargetTableName+';'&#xA;EXEC (@SQLQuery);&#xA;&#xA;SET @SQLQuery = &#xA;'IF EXISTS (&#xA;&#x9;&#x9;&#x9;SELECT object_id&#xA;&#x9;&#x9;&#x9;FROM sys.indexes&#xA;&#x9;&#x9;&#x9;WHERE object_id = OBJECT_ID(''stg.'+@TargetTableName+''')&#xA;&#x9;&#x9;&#x9;&#x9;AND NAME = ''NCIX_'+@TargetTableName+''')'+CHAR(13)+CHAR(10)+ &#xA;'DROP INDEX NCIX_'+@TargetTableName+' ON stg.'+@TargetTableName+';'+CHAR(13)+CHAR(10)+CHAR(13)+CHAR(10)+ &#xA;&#xA;'BULK INSERT stg.'+@TargetTableName+' &#xA; FROM '''+@DataFileRepository+@CustomerDatabase+'\'+@DataFileName+''' &#xA; WITH (FormatFile = '''+@DataFileRepository+@FormatFileRepository+'\'+@ProductKey+'\'+@OdsVersion+'\'+@TargetTableName+'.fmt'');';&#xA;&#xA;--Bulk Insert Data into staging&#x9;&#xA;IF (@FullLoadStatus=0 AND @DataExtractTypeId=0)OR (@FullLoadStatus=1 AND @DataExtractTypeId IN (1,2))&#xA;BEGIN&#x9;&#xA;&#x9;EXEC (@SQLQuery);&#xA;&#x9;SELECT @@ROWCOUNT;&#xA;END&#xA;ELSE IF (@FullLoadStatus=1 AND @DataExtractTypeId=0)&#xA;&#x9;SELECT 0&#xA;ELSE &#xA;&#x9;SELECT -1;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::RowCountExtract" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::DataRepositoryPath"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::FormatFileRepository"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::DataFileName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::CustomerDatabase"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="User::TargetTableName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="5"
                    SQLTask:DtsVariableName="$Package::OdsVersion"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="6"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="7"
                    SQLTask:DtsVariableName="User::FullLoadStatus"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="8"
                    SQLTask:DtsVariableName="$Package::CoreDBVersionId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="9"
                    SQLTask:DtsVariableName="User::LatestCoreDBVersionId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="10"
                    SQLTask:DtsVariableName="User::IsSnapshot"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="11"
                    SQLTask:DtsVariableName="User::ProductKey"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{D8F8FA6D-375E-4A69-8E0C-07B4F6E41F05}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="InsertRecordsFromStagingToTarget"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">(@[$Package::DataExtractTypeId] ==1 &amp;&amp; @[User::FullLoadStatus]==0)||(@[$Package::DataExtractTypeId] ==2 &amp;&amp; @[User::FullLoadStatus]==0)||(@[User::OnError] ==1)?True: False</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{21069D50-2E24-4721-8CA5-626F6EAE007A}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{E9592664-1E2D-4ACE-AAD9-107A63D0DEB4}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{7A55C93D-9E6D-4C8A-AC7F-448239B3E2DD}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                          SQLTask:SqlStatementSource="DECLARE @RowCount INT=?;&#xA;DECLARE @ProcessAuditId INT=?;&#xA;&#xA;UPDATE [adm].[ProcessAudit]&#xA;SET  [Status] = 'I'&#xA; ,[LoadDate] = GETDATE()&#xA; ,[LoadRowCount] = @RowCount &#xA; ,[LastChangeDate] = GETDATE()&#xA;WHERE [ProcessAuditId] = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::RowCountLoad"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;&#x9;&#x9;,@ProcessId INT = ?&#xA;&#x9;&#x9;,@OdsPostingGroupAuditId INT = ?&#xA;&#x9;&#x9;,@SnapshotDate VARCHAR(50) = ?&#xA;&#x9;&#x9;,@DataExtractTypeId INT = ?&#xA;&#x9;&#x9;,@SwitchOut INT = 0&#xA;&#x9;&#x9;,@RowsAffected INT = -1&#xA;&#x9;&#x9;,@returnstatus INT = 0;&#xA;&#xA;&#xA;IF (@DataExtractTypeId = 0)&#xA;EXEC  adm.Etl_CreateUnpartitionedTableSchema @CustomerId,@ProcessId,@SwitchOut,@returnstatus = @returnstatus;&#xA;&#xA;IF (@returnstatus = 0)&#x9;&#x9;&#xA;EXEC adm.Etl_InsertIntoTargetFromStaging @CustomerId,@ProcessId,@OdsPostingGroupAuditId,@SnapshotDate,@DataExtractTypeId,@RowsAffected = @RowsAffected OUTPUT, @returnstatus = @returnstatus OUTPUT;&#xA;SELECT @RowsAffected,@returnstatus;&#xA;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::RowCountLoad" />
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="1"
                    SQLTask:DtsVariableName="User::OnError" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::SnapshotDate"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:Disabled="True"
              DTS:DTSID="{D48B33B1-744F-437E-B958-60356DF732E9}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="ReduceStagingDataWithHashbytes"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">((@[$Package::DataExtractTypeId]==0)||( @[$Package::DataExtractTypeId] ==1 &amp;&amp; @[User::FullLoadStatus]==0)||(@[$Package::DataExtractTypeId] ==2 &amp;&amp; @[User::FullLoadStatus]==0))?True:False</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{29E73FB9-2349-479F-B68A-1A32F16CC28E}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{C57F5D59-B99C-4B87-9579-4FC9F3C490FC}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{7229B45B-5AAB-4440-80DC-2C2BB13A66BF}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessAuditId INT=?&#xA;&#x9;&#x9;,@TotalDeletedRecords INT&#xA;&#x9;&#x9;,@SQLQuery NVARCHAR(MAX)&#xA;&#x9;&#x9;,@TargetTableName VARCHAR(255);&#xA;&#xA;SELECT @TargetTableName = P.TargetTableName&#xA;FROM adm.Process P&#xA;INNER JOIN adm.ProcessAudit PA&#xA;ON P.ProcessId = PA.ProcessId&#xA;WHERE PA.ProcessAuditId = @ProcessAuditId&#xA;&#xA;SET @SQLQuery = 'SELECT @TotalDeletedRecords = COUNT(1) FROM stg.'+@TargetTableName+' WHERE DmlOperation = ''D'';'&#xA;&#xA;EXEC sp_executesql @SQLQuery ,N'@TotalDeletedRecords INT OUT',@TotalDeletedRecords OUT;&#xA;&#xA;UPDATE adm.ProcessAudit&#xA;SET  Status = 'R'&#xA;&#x9;,TotalDeletedRecords = @TotalDeletedRecords&#xA;&#x9;,LastChangeDate = GETDATE()&#xA;WHERE ProcessAuditId = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;&#x9;&#x9;,@ProcessId INT = ?&#xA;&#x9;&#x9;,@OdsPostingGroupAuditId INT = ?&#xA;&#x9;&#x9;,@DataExtractTypeId INT = ?&#xA;&#x9;&#x9;,@returnstatus INT;&#xA;&#x9;&#x9;&#xA;&#xA;EXEC adm.Etl_ReduceStagingDataWithHashbytes @CustomerId,@ProcessId,@OdsPostingGroupAuditId,@DataExtractTypeId, @returnstatus = @returnstatus OUTPUT;&#xA;SELECT @returnstatus"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::OnError" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{C5B1EDAE-0EB4-4F87-803C-4B8C6EFE2DF4}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="SwitchPartitionIn"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">(@[$Package::DataExtractTypeId]==0)||(@[User::OnError] ==1)?False:True</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{1C92045B-3A77-452D-981C-9990838D18A0}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{276EE0E3-B60E-4991-8FAD-C9516D7E20AC}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{BC1E95EF-D0A5-48C8-9F16-A654F5AFDAE4}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessAuditId INT=?&#xA;&#x9;&#x9;,@DataExtractTypeId INT=?;&#xA;&#xA;-- Update Process Status Only if is incremental of Full load was successful&#xA;IF @DataExtractTypeId = 0&#xA;BEGIN&#xA;&#x9;UPDATE [adm].[ProcessAudit]&#xA;&#x9;SET  [Status] = 'U'&#xA;&#x9; ,[LastUpdateDate] = GETDATE()&#xA;&#x9; ,[LastChangeDate] = GETDATE()&#xA;&#x9;WHERE [ProcessAuditId] = @ProcessAuditId&#xA;END" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;&#x9;&#x9;,@ProcessId INT = ?&#xA;&#x9;&#x9;,@TargetNameExtension VARCHAR(100) = ''&#xA;&#x9;&#x9;,@SwitchOut INT = 0&#xA;&#x9;&#x9;,@returnstatus INT;&#xA;&#x9;&#x9;&#xA;-- Create index to match target table&#x9;&#x9;&#xA;EXEC adm.Etl_CreateUnpartitionedTableIndexes @CustomerId,@ProcessId,@returnstatus = @returnstatus OUTPUT;&#xA;&#xA;-- Switch in partition if indexes succesfully created.&#xA;IF @returnstatus = 0&#xA;EXEC adm.Etl_SwitchUnpartitionedTable @CustomerId,@ProcessId,@TargetNameExtension,@SwitchOut,@returnstatus = @returnstatus OUTPUT;&#xA;SELECT @returnstatus;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::OnError" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint]"
              DTS:CreationName=""
              DTS:DTSID="{561C6EE4-6B2B-4F49-9A4C-1BC43C8734FF}"
              DTS:From="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint"
              DTS:To="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 1]"
              DTS:CreationName=""
              DTS:DTSID="{3C54BC1B-0F2F-4EF7-B3D6-62F9F429F226}"
              DTS:From="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 1"
              DTS:To="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 3]"
              DTS:CreationName=""
              DTS:DTSID="{B506C5DB-0345-4512-9E61-6D33456ACC32}"
              DTS:From="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 3"
              DTS:To="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget" />
          </DTS:PrecedenceConstraints>
          <DTS:EventHandlers>
            <DTS:EventHandler
              DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]"
              DTS:CreationName="OnError"
              DTS:DTSID="{A1C01D42-48DE-4DD7-9E6F-2F598B19C39C}"
              DTS:EventID="232316140"
              DTS:EventName="OnError"
              DTS:LocaleID="-1">
              <DTS:Variables>
                <DTS:Variable
                  DTS:CreationName=""
                  DTS:Description="The propagate property of the event"
                  DTS:DTSID="{27DE6B30-CE9C-43E1-8FBD-D1152562E0DF}"
                  DTS:IncludeInDebugDump="6789"
                  DTS:Namespace="System"
                  DTS:ObjectName="Propagate">
                  <DTS:VariableValue
                    DTS:DataType="11">-1</DTS:VariableValue>
                </DTS:Variable>
              </DTS:Variables>
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]\Update Error Variable"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Execute SQL Task"
                  DTS:DTSID="{DA1E95D1-616A-4442-9A9B-F97ECDF635AC}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Update Error Variable">
                  <DTS:Variables />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                      SQLTask:SqlStatementSource="SELECT 1 AS OnError"
                      SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                      <SQLTask:ResultBinding
                        SQLTask:ResultName="0"
                        SQLTask:DtsVariableName="User::OnError" />
                    </SQLTask:SqlTaskData>
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
            </DTS:EventHandler>
          </DTS:EventHandlers>
          <DTS:ForEachVariableMappings>
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{36C053BE-D8D2-4FB1-A249-A8AD8C50630A}"
              DTS:ObjectName="{36C053BE-D8D2-4FB1-A249-A8AD8C50630A}"
              DTS:ValueIndex="0"
              DTS:VariableName="User::DataFileName" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{1532AB51-F077-41F3-B0BE-3717533EE85D}"
              DTS:ObjectName="{1532AB51-F077-41F3-B0BE-3717533EE85D}"
              DTS:ValueIndex="1"
              DTS:VariableName="User::TargetTableName" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{5581800D-DACA-4FEA-855F-E7B26BD6A986}"
              DTS:ObjectName="{5581800D-DACA-4FEA-855F-E7B26BD6A986}"
              DTS:ValueIndex="2"
              DTS:VariableName="User::ProcessId" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{DC277F0B-4EE0-42B5-8B80-A4845C3BE142}"
              DTS:ObjectName="{DC277F0B-4EE0-42B5-8B80-A4845C3BE142}"
              DTS:ValueIndex="3"
              DTS:VariableName="User::IsSnapshot" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{E5A0E7F3-9814-4DF4-8802-95A4EAC14F25}"
              DTS:ObjectName="{E5A0E7F3-9814-4DF4-8802-95A4EAC14F25}"
              DTS:ValueIndex="4"
              DTS:VariableName="User::RowCountControl" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{EF59B4A7-007E-4E3C-BDDD-EA44CF0BA6EF}"
              DTS:ObjectName="{EF59B4A7-007E-4E3C-BDDD-EA44CF0BA6EF}"
              DTS:ValueIndex="5"
              DTS:VariableName="User::TotalRecordsInSource" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{8DE047A2-6DC7-4168-A484-52260BE4BDB3}"
              DTS:ObjectName="{8DE047A2-6DC7-4168-A484-52260BE4BDB3}"
              DTS:ValueIndex="6"
              DTS:VariableName="User::ProductKey" />
          </DTS:ForEachVariableMappings>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:EventHandlers>
        <DTS:EventHandler
          DTS:refId="Package\Process LoadGroup 1.EventHandlers[OnPreExecute]"
          DTS:CreationName="OnPreExecute"
          DTS:DTSID="{BC5B924A-DB6A-4A06-89BF-3FA0232F3059}"
          DTS:EventID="0"
          DTS:EventName="OnPreExecute"
          DTS:LocaleID="-1">
          <DTS:Variables>
            <DTS:Variable
              DTS:CreationName=""
              DTS:Description="The propagate property of the event"
              DTS:DTSID="{B165D443-7C19-4E40-9894-F2ECFCB06F05}"
              DTS:IncludeInDebugDump="6789"
              DTS:Namespace="System"
              DTS:ObjectName="Propagate">
              <DTS:VariableValue
                DTS:DataType="11">-1</DTS:VariableValue>
            </DTS:Variable>
          </DTS:Variables>
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 1.EventHandlers[OnPreExecute]\Get List of Tables to Load"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:Disabled="True"
              DTS:DTSID="{E4B68C43-6B90-416D-AA6E-857E87B1BCA4}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Get List of Tables to Load"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">@[System::SourceName]!="Process LoadGroup 1"</DTS:PropertyExpression>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;&#x9;&#x9;,@CustomerDatabase VARCHAR(100) = ?&#xA;&#x9;&#x9;,@LoadGroup INT = ?&#xA;&#x9;&#x9;,@SnapshotDate VARCHAR(50) = ?&#xA;&#x9;&#x9;,@DataExtractTypeId INT  = ?;&#xA;&#xA;SELECT  DISTINCT&#xA;&#x9; F.DataFileName&#xA;&#x9;,F.TargetTableName&#xA;&#x9;,P.ProcessId&#xA;&#x9;,P.IsSnapshot&#xA;&#x9;,F.RowsExtracted&#xA;&#x9;,F.TotalRowCount&#xA;&#x9;,P.ProductKey&#xA; &#xA;FROM stg.ETL_ControlFiles F &#xA;INNER JOIN adm.Process P ON P.TargetTableName = F.TargetTableName&#xA; AND P.IsActive = 1&#xA; AND F.SnapshotDate = @SnapshotDate&#xA;LEFT OUTER JOIN adm.PostingGroupAudit PGA &#xA; ON PGA.SnapshotCreateDate = F.SnapshotDate&#xA; AND PGA.CustomerId = @CustomerId&#xA;-- Used to exclude completed processes and or Data already in target but still hidden&#xA;LEFT OUTER JOIN adm.ProcessAudit PA&#xA; ON PA.PostingGroupAuditId = PGA.PostingGroupAuditId&#xA; AND PA.ProcessId = P.ProcessId&#xA; AND PA.Status IN ('FI','I','U')&#xA; &#xA;WHERE PGA.Status &lt;&gt; 'FI'&#xA;AND F.DataFileName LIKE '%'+@CustomerDatabase+'%'&#xA;AND P.LoadGroup = CASE WHEN @DataExtractTypeId = 2  THEN P.LoadGroup ELSE @LoadGroup END&#xA;AND PA.ProcessId IS NULL&#xA;&#xA;ORDER BY 3;"
                  SQLTask:ResultType="ResultSetType_Rowset" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::DataFileList" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="$Package::CustomerDatabase"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::LoadGroup"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::SnapshotDate"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
        </DTS:EventHandler>
      </DTS:EventHandlers>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Process LoadGroup 2"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:DelayValidation="True"
      DTS:Description="Sequence Container"
      DTS:DTSID="{E912DA01-1907-4EFF-B72E-9F2BB50E7B60}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Process LoadGroup 2">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{3FE26424-BBA2-4A2F-9406-6A6DA9761282}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="DataFileList">
          <DTS:VariableValue
            DTS:DataSubType="ManagedSerializable"
            DTS:DataType="13">
            <SOAP-ENV:Envelope xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
              <SOAP-ENV:Body>
                <xsd:anyType
                  id="ref-1"></xsd:anyType>
              </SOAP-ENV:Body>
            </SOAP-ENV:Envelope>
          </DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{1D956992-DFBB-44C8-ADAF-81D445E93530}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="DataFileName">
          <DTS:VariableValue
            DTS:DataType="8">MMedical_Ameriprise_20160215012016_BILL_HDR.txt</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{5CF382C1-7982-43D9-8CF3-5CA497411D31}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="FullLoadStatus">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{C7F2DDF1-5D0E-4F54-83C9-AA1B9606C4DC}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="IsSnapshot">
          <DTS:VariableValue
            DTS:DataType="11">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{E1A9116A-E1FF-4F37-80F5-AE616CC4700C}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="LoadGroup">
          <DTS:VariableValue
            DTS:DataType="3">2</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{D39804FA-80C1-4EFB-BC82-3BCE17269459}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="OnError">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{C4DDBB8A-467A-40F0-BF91-F2092E547C81}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="ProcessAuditId">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{C4C92A4A-B962-4FC6-9D78-E8F3A22781CF}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="ProcessId">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{2C2D51F3-96B8-4F90-870E-E635953E4CA2}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="ProductKey">
          <DTS:VariableValue
            DTS:DataType="8">SmartAdvisor</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{6C59C8BC-7BF7-4DD8-A61A-A8A1A30F8D1E}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountControl">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{FB8F8B58-3D3F-4E49-B404-F44034141915}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountExtract">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{EAB22046-FE50-42C4-AB3B-2811C8736EE6}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountLoad">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{56181C17-B6C1-4F17-9B21-3AB89E0006E7}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="TargetTableName">
          <DTS:VariableValue
            DTS:DataType="8"
            xml:space="preserve"></DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{923CDB46-6D77-4462-8111-1CDF05EAAA46}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="TotalRecordsInSource">
          <DTS:VariableValue
            DTS:DataType="20">0</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:PropertyExpression
        DTS:Name="Disable">@[$Package::DataExtractTypeId] == 2 ? True : False</DTS:PropertyExpression>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container"
          DTS:CreationName="STOCK:FOREACHLOOP"
          DTS:DelayValidation="True"
          DTS:Description="Foreach Loop Container"
          DTS:DTSID="{9AE18FCE-CC03-4296-985B-FC84500CCC80}"
          DTS:ExecutableType="STOCK:FOREACHLOOP"
          DTS:LocaleID="-1"
          DTS:MaxErrorCount="100"
          DTS:ObjectName="Foreach Table in PostingGroup Loop Container">
          <DTS:ForEachEnumerator
            DTS:CreationName="Microsoft.ForEachADOEnumerator"
            DTS:DTSID="{6B51E750-3273-4119-B16C-DF7CDEFF641C}"
            DTS:ObjectName="{186133A6-265E-46C2-A15C-27A9C022387E}">
            <DTS:ObjectData>
              <FEEADO
                EnumType="EnumerateRowsInFirstTable"
                VarName="User::DataFileList" />
            </DTS:ObjectData>
          </DTS:ForEachEnumerator>
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="Disable">@[User::OdsPostingGroupAuditId] == 0 ? True: False</DTS:PropertyExpression>
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{9FACCB21-3A29-44EA-BA0E-60F7A81DAB99}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="BulkInsertIntoStaging"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="1">
              <DTS:Variables />
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{79FFFC7B-FF83-4CEC-91EA-24DD696D6DD8}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{450E6CBC-C80B-4E5F-AA23-540C5E2426E7}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{96AD6C11-32B4-4386-BABF-885C5BAA3317}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">(@[User::OnError] ==1)||(@[User::RowCountExtract]==-1 )? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                          SQLTask:SqlStatementSource="DECLARE @RowCount INT=?;&#xA;DECLARE @ProcessAuditId INT=?;&#xA;&#xA;UPDATE [adm].[ProcessAudit]&#xA;SET  [Status] = 'L'&#xA; ,[ExtractDate] = GETDATE()&#xA; ,[ExtractRowCount] = @RowCount &#xA; ,[LastChangeDate] = GETDATE()&#xA;WHERE [ProcessAuditId] = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::RowCountExtract"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]"
                  DTS:CreationName="OnPreExecute"
                  DTS:DTSID="{1F2E1FB7-7DD5-440F-ACCC-C6848049509A}"
                  DTS:EventID="0"
                  DTS:EventName="OnPreExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{4AC0CDBE-F616-41F8-B5C7-87AFBB72095E}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{C9271DB3-74F1-462D-ACD8-2A1B3BF4B36E}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Generate ProcessAuditId"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessId INT=?&#xA;  ,@ControlRowCount INT=?&#xA;  ,@CustomerId INT=?&#xA;  ,@IsSnapshot INT=?&#xA;  ,@PostingGroupAuditId INT=?&#xA;  ,@DataExtractTypeId INT=?&#xA;  ,@TotalRecordsInSource BIGINT=?;&#xA;&#xA;EXEC adm.Etl_GetProcessAuditId @ProcessId,@ControlRowCount,@TotalRecordsInSource,@CustomerId,@IsSnapshot,@PostingGroupAuditId,@DataExtractTypeId"
                          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId" />
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="1"
                            SQLTask:DtsVariableName="User::FullLoadStatus" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::RowCountControl"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="2"
                            SQLTask:DtsVariableName="$Package::CustomerId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="3"
                            SQLTask:DtsVariableName="User::IsSnapshot"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="4"
                            SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="5"
                            SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="6"
                            SQLTask:DtsVariableName="User::TotalRecordsInSource"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{02EEE393-EA6C-4B2D-8E18-E089BE711365}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Error Variable">
                      <DTS:Variables />
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                          SQLTask:SqlStatementSource="SELECT 0 AS OnError"
                          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="0"
                            SQLTask:DtsVariableName="User::OnError" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                  <DTS:PrecedenceConstraints>
                    <DTS:PrecedenceConstraint
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint]"
                      DTS:CreationName=""
                      DTS:DTSID="{D3A41154-0029-47DA-B85E-F06849FECFF8}"
                      DTS:From="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
                      DTS:LogicalAnd="True"
                      DTS:ObjectName="Constraint"
                      DTS:To="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId" />
                  </DTS:PrecedenceConstraints>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                  SQLTask:SqlStatementSource="DECLARE  @DataFileRepository VARCHAR(255) = ?&#xA;&#x9;&#x9;,@FormatFileRepository VARCHAR(255) = ?&#xA;&#x9;&#x9;,@DataFileName VARCHAR(255) = ?&#xA;&#x9;&#x9;,@CustomerDatabase VARCHAR(100) = ?&#xA;&#x9;&#x9;,@TargetTableName VARCHAR(255) = ?&#xA;&#x9;&#x9;,@OdsVersion VARCHAR(20) = ?&#xA;&#x9;&#x9;,@DataExtractTypeId INT=?&#xA;&#x9;&#x9;,@FullLoadStatus INT=?&#xA;&#x9;&#x9;,@CoreDBVersionId INT=?&#xA;&#x9;&#x9;,@LatestCoreDBVersionId INT=?&#xA;&#x9;&#x9;,@IsSnapshot INT=?&#xA;&#x9;&#x9;,@ProductKey VARCHAR(100)=?&#xA;&#x9;&#x9;,@SQLQuery VARCHAR(MAX);&#xA;&#xA;-- Truncate Staging table and drop any indexes that exist.&#xA;SET @SQLQuery=&#xA;'TRUNCATE TABLE stg.'+@TargetTableName+';'&#xA;EXEC (@SQLQuery);&#xA;&#xA;SET @SQLQuery = &#xA;'IF EXISTS (&#xA;&#x9;&#x9;&#x9;SELECT object_id&#xA;&#x9;&#x9;&#x9;FROM sys.indexes&#xA;&#x9;&#x9;&#x9;WHERE object_id = OBJECT_ID(''stg.'+@TargetTableName+''')&#xA;&#x9;&#x9;&#x9;&#x9;AND NAME = ''NCIX_'+@TargetTableName+''')'+CHAR(13)+CHAR(10)+ &#xA;'DROP INDEX NCIX_'+@TargetTableName+' ON stg.'+@TargetTableName+';'+CHAR(13)+CHAR(10)+CHAR(13)+CHAR(10)+ &#xA;&#xA;'BULK INSERT stg.'+@TargetTableName+' &#xA; FROM '''+@DataFileRepository+@CustomerDatabase+'\'+@DataFileName+''' &#xA; WITH (FormatFile = '''+@DataFileRepository+@FormatFileRepository+'\'+@ProductKey+'\'+@OdsVersion+'\'+@TargetTableName+'.fmt'');';&#xA;&#xA;--Bulk Insert Data into staging&#x9;&#xA;IF (@FullLoadStatus=0 AND @DataExtractTypeId=0)OR (@FullLoadStatus=1 AND @DataExtractTypeId IN (1,2))&#xA;BEGIN&#x9;&#xA;&#x9;EXEC (@SQLQuery);&#xA;&#x9;SELECT @@ROWCOUNT;&#xA;END&#xA;ELSE IF (@FullLoadStatus=1 AND @DataExtractTypeId=0)&#xA;&#x9;SELECT 0&#xA;ELSE &#xA;&#x9;SELECT -1;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::RowCountExtract" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::DataRepositoryPath"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::FormatFileRepository"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::DataFileName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::CustomerDatabase"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="User::TargetTableName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="5"
                    SQLTask:DtsVariableName="$Package::OdsVersion"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="6"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="7"
                    SQLTask:DtsVariableName="User::FullLoadStatus"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="8"
                    SQLTask:DtsVariableName="$Package::CoreDBVersionId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="9"
                    SQLTask:DtsVariableName="User::LatestCoreDBVersionId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="10"
                    SQLTask:DtsVariableName="User::IsSnapshot"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="11"
                    SQLTask:DtsVariableName="User::ProductKey"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{0B76960F-7626-4786-BCDF-02281130D9F0}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="InsertRecordsFromStagingToTarget"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="1">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">(@[$Package::DataExtractTypeId] ==1 &amp;&amp; @[User::FullLoadStatus]==0)||(@[$Package::DataExtractTypeId] ==2 &amp;&amp; @[User::FullLoadStatus]==0)||(@[User::OnError] ==1)?True: False</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{75314B7E-808B-47F0-95BF-9AB732D58D91}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{0AB60E0C-22EB-4FC7-BBAC-98D5E0389511}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{030DE6F6-123C-4050-A8EE-ABA483E1AF1C}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                          SQLTask:SqlStatementSource="DECLARE @RowCount INT=?;&#xA;DECLARE @ProcessAuditId INT=?;&#xA;&#xA;UPDATE [adm].[ProcessAudit]&#xA;SET  [Status] = 'I'&#xA; ,[LoadDate] = GETDATE()&#xA; ,[LoadRowCount] = @RowCount &#xA; ,[LastChangeDate] = GETDATE()&#xA;WHERE [ProcessAuditId] = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::RowCountLoad"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;&#x9;&#x9;,@ProcessId INT = ?&#xA;&#x9;&#x9;,@OdsPostingGroupAuditId INT = ?&#xA;&#x9;&#x9;,@SnapshotDate VARCHAR(50) = ?&#xA;&#x9;&#x9;,@DataExtractTypeId INT = ?&#xA;&#x9;&#x9;,@SwitchOut INT = 0&#xA;&#x9;&#x9;,@RowsAffected INT = -1&#xA;&#x9;&#x9;,@returnstatus INT = 0;&#xA;&#xA;&#xA;IF (@DataExtractTypeId = 0)&#xA;EXEC  adm.Etl_CreateUnpartitionedTableSchema @CustomerId,@ProcessId,@SwitchOut,@returnstatus = @returnstatus;&#xA;&#xA;IF (@returnstatus = 0)&#x9;&#x9;&#xA;EXEC adm.Etl_InsertIntoTargetFromStaging @CustomerId,@ProcessId,@OdsPostingGroupAuditId,@SnapshotDate,@DataExtractTypeId,@RowsAffected = @RowsAffected OUTPUT, @returnstatus = @returnstatus OUTPUT;&#xA;SELECT @RowsAffected,@returnstatus;&#xA;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::RowCountLoad" />
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="1"
                    SQLTask:DtsVariableName="User::OnError" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::SnapshotDate"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:Disabled="True"
              DTS:DTSID="{11FB9F20-B4EB-4F93-8458-325E5DA24546}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="ReduceStagingDataWithHashbytes"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="1">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">((@[$Package::DataExtractTypeId]==0)||( @[$Package::DataExtractTypeId] ==1 &amp;&amp; @[User::FullLoadStatus]==0)||(@[$Package::DataExtractTypeId] ==2 &amp;&amp; @[User::FullLoadStatus]==0))?True:False</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{74CA2587-B12B-4A16-A4D5-66F1047F7618}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{FACC3416-4BD7-4686-94D5-2B1CBD898346}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{6D7B950B-CD0B-4775-9766-06C404F4CC12}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessAuditId INT=?&#xA;&#x9;&#x9;,@TotalDeletedRecords INT&#xA;&#x9;&#x9;,@SQLQuery NVARCHAR(MAX)&#xA;&#x9;&#x9;,@TargetTableName VARCHAR(255);&#xA;&#xA;SELECT @TargetTableName = P.TargetTableName&#xA;FROM adm.Process P&#xA;INNER JOIN adm.ProcessAudit PA&#xA;ON P.ProcessId = PA.ProcessId&#xA;WHERE PA.ProcessAuditId = @ProcessAuditId&#xA;&#xA;SET @SQLQuery = 'SELECT @TotalDeletedRecords = COUNT(1) FROM stg.'+@TargetTableName+' WHERE DmlOperation = ''D'';'&#xA;&#xA;EXEC sp_executesql @SQLQuery ,N'@TotalDeletedRecords INT OUT',@TotalDeletedRecords OUT;&#xA;&#xA;UPDATE adm.ProcessAudit&#xA;SET  Status = 'R'&#xA;&#x9;,TotalDeletedRecords = @TotalDeletedRecords&#xA;&#x9;,LastChangeDate = GETDATE()&#xA;WHERE ProcessAuditId = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;  ,@ProcessId INT = ?&#xA;  ,@OdsPostingGroupAuditId INT = ?&#xA;  ,@DataExtractTypeId INT = ?&#xA;  ,@returnstatus INT;&#xA;  &#xA;&#xA;EXEC adm.Etl_ReduceStagingDataWithHashbytes @CustomerId,@ProcessId,@OdsPostingGroupAuditId,@DataExtractTypeId, @returnstatus = @returnstatus OUTPUT;&#xA;SELECT @returnstatus"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::OnError" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{7F9413AE-FB8C-4399-A60D-1255E0E70EE9}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="SwitchPartitionIn"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="1">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">(@[$Package::DataExtractTypeId]==0)||(@[User::OnError] ==1)?False:True</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{67A4EA93-9C0F-4FDF-9820-97BC54A64014}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{948A4E59-8ECD-421A-AC65-B8A646B69EE7}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{B2C1FE17-229E-4373-B8B6-47CD7A078E33}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessAuditId INT=?&#xA;  ,@DataExtractTypeId INT=?;&#xA;&#xA;-- Update Process Status Only if is incremental of Full load was successful&#xA;IF @DataExtractTypeId = 0&#xA;BEGIN&#xA; UPDATE [adm].[ProcessAudit]&#xA; SET  [Status] = 'U'&#xA;  ,[LastUpdateDate] = GETDATE()&#xA;  ,[LastChangeDate] = GETDATE()&#xA; WHERE [ProcessAuditId] = @ProcessAuditId&#xA;END" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;  ,@ProcessId INT = ?&#xA;  ,@TargetNameExtension VARCHAR(100) = ''&#xA;  ,@SwitchOut INT = 0&#xA;  ,@returnstatus INT;&#xA;  &#xA;-- Create index to match target table  &#xA;EXEC adm.Etl_CreateUnpartitionedTableIndexes @CustomerId,@ProcessId,@returnstatus = @returnstatus OUTPUT;&#xA;&#xA;-- Switch in partition if indexes succesfully created.&#xA;IF @returnstatus = 0&#xA;EXEC adm.Etl_SwitchUnpartitionedTable @CustomerId,@ProcessId,@TargetNameExtension,@SwitchOut,@returnstatus = @returnstatus OUTPUT;&#xA;SELECT @returnstatus;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::OnError" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint]"
              DTS:CreationName=""
              DTS:DTSID="{ABFAF9A5-2C7E-46F4-BE1A-2C6206F605F2}"
              DTS:From="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint"
              DTS:To="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 1]"
              DTS:CreationName=""
              DTS:DTSID="{108F82A2-8B87-4115-8204-2BD73A7A7AB2}"
              DTS:From="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 1"
              DTS:To="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 3]"
              DTS:CreationName=""
              DTS:DTSID="{1A05DC7B-7AB5-4EDD-B3FB-9E395ECB335F}"
              DTS:From="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 3"
              DTS:To="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget" />
          </DTS:PrecedenceConstraints>
          <DTS:EventHandlers>
            <DTS:EventHandler
              DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]"
              DTS:CreationName="OnError"
              DTS:DTSID="{2FDC4C53-3B41-46A4-B2C2-4B7219CA8F74}"
              DTS:EventID="232316140"
              DTS:EventName="OnError"
              DTS:LocaleID="-1">
              <DTS:Variables>
                <DTS:Variable
                  DTS:CreationName=""
                  DTS:Description="The propagate property of the event"
                  DTS:DTSID="{7ABD7F0F-B7BF-482F-B80A-3E5C73550A0A}"
                  DTS:IncludeInDebugDump="6789"
                  DTS:Namespace="System"
                  DTS:ObjectName="Propagate">
                  <DTS:VariableValue
                    DTS:DataType="11">-1</DTS:VariableValue>
                </DTS:Variable>
              </DTS:Variables>
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]\Update Error Variable"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Execute SQL Task"
                  DTS:DTSID="{EA650383-8504-473B-81A4-9E5DF3165B66}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Update Error Variable">
                  <DTS:Variables />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                      SQLTask:SqlStatementSource="SELECT 1 AS OnError"
                      SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                      <SQLTask:ResultBinding
                        SQLTask:ResultName="0"
                        SQLTask:DtsVariableName="User::OnError" />
                    </SQLTask:SqlTaskData>
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
            </DTS:EventHandler>
          </DTS:EventHandlers>
          <DTS:ForEachVariableMappings>
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{DBA72042-44FA-4D16-9D77-5A6D9A2E7556}"
              DTS:ObjectName="{DBA72042-44FA-4D16-9D77-5A6D9A2E7556}"
              DTS:ValueIndex="0"
              DTS:VariableName="User::DataFileName" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{189FD69A-BE46-4EC7-8588-31AC50CC6668}"
              DTS:ObjectName="{189FD69A-BE46-4EC7-8588-31AC50CC6668}"
              DTS:ValueIndex="1"
              DTS:VariableName="User::TargetTableName" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{7B0E9DF3-0619-4B5C-8176-F2E1436656BB}"
              DTS:ObjectName="{7B0E9DF3-0619-4B5C-8176-F2E1436656BB}"
              DTS:ValueIndex="2"
              DTS:VariableName="User::ProcessId" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{2875AC4F-FE3C-4992-98A0-93FF5EE45977}"
              DTS:ObjectName="{2875AC4F-FE3C-4992-98A0-93FF5EE45977}"
              DTS:ValueIndex="3"
              DTS:VariableName="User::IsSnapshot" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{B9C32648-5769-4CCF-A85E-8E56A27BBDAD}"
              DTS:ObjectName="{B9C32648-5769-4CCF-A85E-8E56A27BBDAD}"
              DTS:ValueIndex="4"
              DTS:VariableName="User::RowCountControl" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{2DC6E6E1-4E69-4F93-AB95-DD9137B42135}"
              DTS:ObjectName="{2DC6E6E1-4E69-4F93-AB95-DD9137B42135}"
              DTS:ValueIndex="5"
              DTS:VariableName="User::TotalRecordsInSource" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{9EEF1A52-D470-46A9-9C7C-E57381BB3857}"
              DTS:ObjectName="{9EEF1A52-D470-46A9-9C7C-E57381BB3857}"
              DTS:ValueIndex="6"
              DTS:VariableName="User::ProductKey" />
          </DTS:ForEachVariableMappings>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:EventHandlers>
        <DTS:EventHandler
          DTS:refId="Package\Process LoadGroup 2.EventHandlers[OnPreExecute]"
          DTS:CreationName="OnPreExecute"
          DTS:DTSID="{B6237F08-C54E-4980-9066-E6BD88A2100C}"
          DTS:EventID="0"
          DTS:EventName="OnPreExecute"
          DTS:LocaleID="-1">
          <DTS:Variables>
            <DTS:Variable
              DTS:CreationName=""
              DTS:Description="The propagate property of the event"
              DTS:DTSID="{7FC20E9B-6848-4D3A-9C9E-957839C532F6}"
              DTS:IncludeInDebugDump="6789"
              DTS:Namespace="System"
              DTS:ObjectName="Propagate">
              <DTS:VariableValue
                DTS:DataType="11">-1</DTS:VariableValue>
            </DTS:Variable>
          </DTS:Variables>
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 2.EventHandlers[OnPreExecute]\Get List of Tables to Load"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:Disabled="True"
              DTS:DTSID="{33DB43B9-F3BC-4313-B7E5-9F80CABEA8D4}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Get List of Tables to Load"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">@[System::SourceName]!="Process LoadGroup 2"</DTS:PropertyExpression>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;  ,@CustomerDatabase VARCHAR(100)=?&#xA;  ,@LoadGroup INT = ?&#xA;  ,@SnapshotDate VARCHAR(50) = ?;&#xA;&#xA;SELECT  DISTINCT&#xA;&#x9; F.DataFileName&#xA;&#x9;,F.TargetTableName&#xA;&#x9;,P.ProcessId&#xA;&#x9;,P.IsSnapshot&#xA;&#x9;,F.RowsExtracted&#xA;&#x9;,F.TotalRowCount&#xA;&#x9;,P.ProductKey&#xA; &#xA;FROM stg.ETL_ControlFiles F &#xA;INNER JOIN adm.Process P ON P.TargetTableName = F.TargetTableName&#xA; AND P.IsActive = 1&#xA; AND F.SnapshotDate = @SnapshotDate&#xA;LEFT OUTER JOIN adm.PostingGroupAudit PGA &#xA; ON PGA.SnapshotCreateDate = F.SnapshotDate&#xA; AND PGA.CustomerId = @CustomerId&#xA;-- Used to exclude completed processes and or Data already in target but still hidden&#xA;LEFT OUTER JOIN adm.ProcessAudit PA&#xA; ON PA.PostingGroupAuditId = PGA.PostingGroupAuditId&#xA; AND PA.ProcessId = P.ProcessId&#xA; AND PA.Status IN ('FI','I','U')&#xA; &#xA;WHERE PGA.Status &lt;&gt; 'FI'&#xA;AND F.DataFileName LIKE '%'+@CustomerDatabase+'%'&#xA;AND P.LoadGroup = @LoadGroup&#xA;AND PA.ProcessId IS NULL&#xA;&#xA;ORDER BY 3;&#xA;"
                  SQLTask:ResultType="ResultSetType_Rowset" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::DataFileList" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="$Package::CustomerDatabase"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::LoadGroup"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::SnapshotDate"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
        </DTS:EventHandler>
      </DTS:EventHandlers>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Process LoadGroup 3"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:DelayValidation="True"
      DTS:Description="Sequence Container"
      DTS:DTSID="{B5E289C1-D2D0-49E5-8140-CDBFB875BAE3}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Process LoadGroup 3">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{A9ABFE5D-A8B3-466E-B389-5D7E44FA2DAA}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="DataFileList">
          <DTS:VariableValue
            DTS:DataSubType="ManagedSerializable"
            DTS:DataType="13">
            <SOAP-ENV:Envelope xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
              <SOAP-ENV:Body>
                <xsd:anyType
                  id="ref-1"></xsd:anyType>
              </SOAP-ENV:Body>
            </SOAP-ENV:Envelope>
          </DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{343B975D-00B8-4E9C-9A06-355F17B66E72}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="DataFileName">
          <DTS:VariableValue
            DTS:DataType="8">MMedical_Ameriprise_20160215012016_BILL_HDR.txt</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{2ABFA23E-DC3D-4736-A41F-3F6DFD60ACA8}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="FullLoadStatus">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{ED2DA94D-6ACB-4A95-BDDE-A141E1269708}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="IsSnapshot">
          <DTS:VariableValue
            DTS:DataType="11">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{A774B1D0-B216-4A9B-BD9B-BAE9D0450AE0}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="LoadGroup">
          <DTS:VariableValue
            DTS:DataType="3">3</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{19A9A192-2C2C-4984-B381-00D551F54934}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="OnError">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{08A07BBD-2644-4E5E-9DB0-5BDE8C273110}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="ProcessAuditId">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{07CC8CAC-157C-446A-9697-5BC328FE4BF6}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="ProcessId">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{EED41653-7398-4FB2-88C1-FCDE6331F60E}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="ProductKey">
          <DTS:VariableValue
            DTS:DataType="8">SmartAdvisor</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{1BB9B577-F43D-4626-B26C-DFAFD0F797D3}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountControl">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{9F01FF21-AA9A-4C11-8EA9-195A093FB156}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountExtract">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{3589CA0F-DA4B-4787-95C5-95A56D7B6D1D}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="RowCountLoad">
          <DTS:VariableValue
            DTS:DataType="3">0</DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{664933A4-37BF-4148-A999-7E37CB51794F}"
          DTS:IncludeInDebugDump="2345"
          DTS:Namespace="User"
          DTS:ObjectName="TargetTableName">
          <DTS:VariableValue
            DTS:DataType="8"
            xml:space="preserve"></DTS:VariableValue>
        </DTS:Variable>
        <DTS:Variable
          DTS:CreationName=""
          DTS:DTSID="{1BCC90BB-2B5D-49C6-9BAB-0542ADDEA981}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="User"
          DTS:ObjectName="TotalRecordsInSource">
          <DTS:VariableValue
            DTS:DataType="20">0</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:PropertyExpression
        DTS:Name="Disable">@[$Package::DataExtractTypeId] == 2 ? True : False</DTS:PropertyExpression>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container"
          DTS:CreationName="STOCK:FOREACHLOOP"
          DTS:DelayValidation="True"
          DTS:Description="Foreach Loop Container"
          DTS:DTSID="{D4C8D8F8-59C3-41E5-80B0-FC3B8DCB86CD}"
          DTS:ExecutableType="STOCK:FOREACHLOOP"
          DTS:LocaleID="-1"
          DTS:MaxErrorCount="100"
          DTS:ObjectName="Foreach Table in PostingGroup Loop Container">
          <DTS:ForEachEnumerator
            DTS:CreationName="Microsoft.ForEachADOEnumerator"
            DTS:DTSID="{71DD86D0-F2C6-4E90-BC1E-CCA406F645EB}"
            DTS:ObjectName="{186133A6-265E-46C2-A15C-27A9C022387E}">
            <DTS:ObjectData>
              <FEEADO
                EnumType="EnumerateRowsInFirstTable"
                VarName="User::DataFileList" />
            </DTS:ObjectData>
          </DTS:ForEachEnumerator>
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="Disable">@[User::OdsPostingGroupAuditId] == 0 ? True: False</DTS:PropertyExpression>
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{6D3500F2-E4FE-4CE0-B54F-BBFB63678FC6}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="BulkInsertIntoStaging"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="2">
              <DTS:Variables />
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{F3931860-1F4B-458D-9F4A-8816C76902C4}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{7FEB5939-EBD4-4E3E-92E0-AD5476985B79}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{93F48D80-6816-45D1-8F18-58B316BAACF2}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">(@[User::OnError] ==1)||(@[User::RowCountExtract]==-1 )? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                          SQLTask:SqlStatementSource="DECLARE @RowCount INT=?;&#xA;DECLARE @ProcessAuditId INT=?;&#xA;&#xA;UPDATE [adm].[ProcessAudit]&#xA;SET  [Status] = 'L'&#xA; ,[ExtractDate] = GETDATE()&#xA; ,[ExtractRowCount] = @RowCount &#xA; ,[LastChangeDate] = GETDATE()&#xA;WHERE [ProcessAuditId] = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::RowCountExtract"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]"
                  DTS:CreationName="OnPreExecute"
                  DTS:DTSID="{FE175E0F-FAB7-4E07-A7CF-D65676DEC81E}"
                  DTS:EventID="0"
                  DTS:EventName="OnPreExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{D6CA2B1F-E915-44B2-838F-BAEF8BC9ECF9}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{41B38654-0BF6-4478-9DEB-89A89AF5A6AC}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Generate ProcessAuditId"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessId INT=?&#xA;  ,@ControlRowCount INT=?&#xA;  ,@CustomerId INT=?&#xA;  ,@IsSnapshot INT=?&#xA;  ,@PostingGroupAuditId INT=?&#xA;  ,@DataExtractTypeId INT=?&#xA;  ,@TotalRecordsInSource BIGINT=?;&#xA;&#xA;EXEC adm.Etl_GetProcessAuditId @ProcessId,@ControlRowCount,@TotalRecordsInSource,@CustomerId,@IsSnapshot,@PostingGroupAuditId,@DataExtractTypeId"
                          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId" />
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="1"
                            SQLTask:DtsVariableName="User::FullLoadStatus" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::RowCountControl"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="2"
                            SQLTask:DtsVariableName="$Package::CustomerId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="3"
                            SQLTask:DtsVariableName="User::IsSnapshot"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="4"
                            SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="5"
                            SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="6"
                            SQLTask:DtsVariableName="User::TotalRecordsInSource"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{8282C7B2-B8B4-4A07-90F8-F3626371DAD0}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Error Variable">
                      <DTS:Variables />
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                          SQLTask:SqlStatementSource="SELECT 0 AS OnError"
                          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ResultBinding
                            SQLTask:ResultName="0"
                            SQLTask:DtsVariableName="User::OnError" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                  <DTS:PrecedenceConstraints>
                    <DTS:PrecedenceConstraint
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint]"
                      DTS:CreationName=""
                      DTS:DTSID="{D098576A-C1A7-4D3F-999B-44D32DDBF5DC}"
                      DTS:From="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
                      DTS:LogicalAnd="True"
                      DTS:ObjectName="Constraint"
                      DTS:To="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId" />
                  </DTS:PrecedenceConstraints>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                  SQLTask:SqlStatementSource="DECLARE  @DataFileRepository VARCHAR(255) = ?&#xA;&#x9;&#x9;,@FormatFileRepository VARCHAR(255) = ?&#xA;&#x9;&#x9;,@DataFileName VARCHAR(255) = ?&#xA;&#x9;&#x9;,@CustomerDatabase VARCHAR(100) = ?&#xA;&#x9;&#x9;,@TargetTableName VARCHAR(255) = ?&#xA;&#x9;&#x9;,@OdsVersion VARCHAR(20) = ?&#xA;&#x9;&#x9;,@DataExtractTypeId INT=?&#xA;&#x9;&#x9;,@FullLoadStatus INT=?&#xA;&#x9;&#x9;,@CoreDBVersionId INT=?&#xA;&#x9;&#x9;,@LatestCoreDBVersionId INT=?&#xA;&#x9;&#x9;,@IsSnapshot INT=?&#xA;&#x9;&#x9;,@ProductKey VARCHAR(100)=?&#xA;&#x9;&#x9;,@SQLQuery VARCHAR(MAX);&#xA;&#xA;-- Truncate Staging table and drop any indexes that exist.&#xA;SET @SQLQuery=&#xA;'TRUNCATE TABLE stg.'+@TargetTableName+';'&#xA;EXEC (@SQLQuery);&#xA;&#xA;SET @SQLQuery = &#xA;'IF EXISTS (&#xA;&#x9;&#x9;&#x9;SELECT object_id&#xA;&#x9;&#x9;&#x9;FROM sys.indexes&#xA;&#x9;&#x9;&#x9;WHERE object_id = OBJECT_ID(''stg.'+@TargetTableName+''')&#xA;&#x9;&#x9;&#x9;&#x9;AND NAME = ''NCIX_'+@TargetTableName+''')'+CHAR(13)+CHAR(10)+ &#xA;'DROP INDEX NCIX_'+@TargetTableName+' ON stg.'+@TargetTableName+';'+CHAR(13)+CHAR(10)+CHAR(13)+CHAR(10)+ &#xA;&#xA;'BULK INSERT stg.'+@TargetTableName+' &#xA; FROM '''+@DataFileRepository+@CustomerDatabase+'\'+@DataFileName+''' &#xA; WITH (FormatFile = '''+@DataFileRepository+@FormatFileRepository+'\'+@ProductKey+'\'+@OdsVersion+'\'+@TargetTableName+'.fmt'');';&#xA;&#xA;--Bulk Insert Data into staging&#x9;&#xA;IF (@FullLoadStatus=0 AND @DataExtractTypeId=0)OR (@FullLoadStatus=1 AND @DataExtractTypeId IN (1,2))&#xA;BEGIN&#x9;&#xA;&#x9;EXEC (@SQLQuery);&#xA;&#x9;SELECT @@ROWCOUNT;&#xA;END&#xA;ELSE IF (@FullLoadStatus=1 AND @DataExtractTypeId=0)&#xA;&#x9;SELECT 0&#xA;ELSE &#xA;&#x9;SELECT -1;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::RowCountExtract" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::DataRepositoryPath"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::FormatFileRepository"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::DataFileName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::CustomerDatabase"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="User::TargetTableName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="5"
                    SQLTask:DtsVariableName="$Package::OdsVersion"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="6"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="7"
                    SQLTask:DtsVariableName="User::FullLoadStatus"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="8"
                    SQLTask:DtsVariableName="$Package::CoreDBVersionId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="9"
                    SQLTask:DtsVariableName="User::LatestCoreDBVersionId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="10"
                    SQLTask:DtsVariableName="User::IsSnapshot"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="11"
                    SQLTask:DtsVariableName="User::ProductKey"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{2DBDD43B-2E31-4B51-B182-B99E35C75B5F}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="InsertRecordsFromStagingToTarget"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="2">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">(@[$Package::DataExtractTypeId] ==1 &amp;&amp; @[User::FullLoadStatus]==0)||(@[$Package::DataExtractTypeId] ==2 &amp;&amp; @[User::FullLoadStatus]==0)||(@[User::OnError] ==1)?True: False</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{D1642F77-77E6-4A29-A8F9-E0D89FFE7FD7}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{6029C443-16A4-4688-8667-FDA6AB253169}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{B710F1C3-F3BA-4923-B497-ECABEC39E898}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                          SQLTask:SqlStatementSource="DECLARE @RowCount INT=?;&#xA;DECLARE @ProcessAuditId INT=?;&#xA;&#xA;UPDATE [adm].[ProcessAudit]&#xA;SET  [Status] = 'I'&#xA; ,[LoadDate] = GETDATE()&#xA; ,[LoadRowCount] = @RowCount &#xA; ,[LastChangeDate] = GETDATE()&#xA;WHERE [ProcessAuditId] = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::RowCountLoad"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;&#x9;&#x9;,@ProcessId INT = ?&#xA;&#x9;&#x9;,@OdsPostingGroupAuditId INT = ?&#xA;&#x9;&#x9;,@SnapshotDate VARCHAR(50) = ?&#xA;&#x9;&#x9;,@DataExtractTypeId INT = ?&#xA;&#x9;&#x9;,@SwitchOut INT = 0&#xA;&#x9;&#x9;,@RowsAffected INT = -1&#xA;&#x9;&#x9;,@returnstatus INT = 0;&#xA;&#xA;&#xA;IF (@DataExtractTypeId = 0)&#xA;EXEC  adm.Etl_CreateUnpartitionedTableSchema @CustomerId,@ProcessId,@SwitchOut,@returnstatus = @returnstatus;&#xA;&#xA;IF (@returnstatus = 0)&#x9;&#x9;&#xA;EXEC adm.Etl_InsertIntoTargetFromStaging @CustomerId,@ProcessId,@OdsPostingGroupAuditId,@SnapshotDate,@DataExtractTypeId,@RowsAffected = @RowsAffected OUTPUT, @returnstatus = @returnstatus OUTPUT;&#xA;SELECT @RowsAffected,@returnstatus;&#xA;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::RowCountLoad" />
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="1"
                    SQLTask:DtsVariableName="User::OnError" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::SnapshotDate"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:Disabled="True"
              DTS:DTSID="{CD9FB70A-04A2-40D7-8980-8541190BA4E1}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="ReduceStagingDataWithHashbytes"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="2">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">((@[$Package::DataExtractTypeId]==0)||( @[$Package::DataExtractTypeId] ==1 &amp;&amp; @[User::FullLoadStatus]==0)||(@[$Package::DataExtractTypeId] ==2 &amp;&amp; @[User::FullLoadStatus]==0))?True:False</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{24EFA75B-0D17-4C97-91F1-0492E81D8D23}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{0CFB1290-D8FE-4BAE-A896-BAB224D12BEE}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{B6FF62F2-193F-4499-9CF6-F3C2A441EDD1}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessAuditId INT=?&#xA;&#x9;&#x9;,@TotalDeletedRecords INT&#xA;&#x9;&#x9;,@SQLQuery NVARCHAR(MAX)&#xA;&#x9;&#x9;,@TargetTableName VARCHAR(255);&#xA;&#xA;SELECT @TargetTableName = P.TargetTableName&#xA;FROM adm.Process P&#xA;INNER JOIN adm.ProcessAudit PA&#xA;ON P.ProcessId = PA.ProcessId&#xA;WHERE PA.ProcessAuditId = @ProcessAuditId&#xA;&#xA;SET @SQLQuery = 'SELECT @TotalDeletedRecords = COUNT(1) FROM stg.'+@TargetTableName+' WHERE DmlOperation = ''D'';'&#xA;&#xA;EXEC sp_executesql @SQLQuery ,N'@TotalDeletedRecords INT OUT',@TotalDeletedRecords OUT;&#xA;&#xA;UPDATE adm.ProcessAudit&#xA;SET  Status = 'R'&#xA;&#x9;,TotalDeletedRecords = @TotalDeletedRecords&#xA;&#x9;,LastChangeDate = GETDATE()&#xA;WHERE ProcessAuditId = @ProcessAuditId" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;  ,@ProcessId INT = ?&#xA;  ,@OdsPostingGroupAuditId INT = ?&#xA;  ,@DataExtractTypeId INT = ?&#xA;  ,@returnstatus INT;&#xA;  &#xA;&#xA;EXEC adm.Etl_ReduceStagingDataWithHashbytes @CustomerId,@ProcessId,@OdsPostingGroupAuditId,@DataExtractTypeId, @returnstatus = @returnstatus OUTPUT;&#xA;SELECT @returnstatus"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::OnError" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{93B97E26-77F3-4448-9C18-7C151CEA045F}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="SwitchPartitionIn"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="2">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">(@[$Package::DataExtractTypeId]==0)||(@[User::OnError] ==1)?False:True</DTS:PropertyExpression>
              <DTS:EventHandlers>
                <DTS:EventHandler
                  DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]"
                  DTS:CreationName="OnPostExecute"
                  DTS:DTSID="{8C3BF407-E731-48E4-94F5-A4B4AC613653}"
                  DTS:EventID="0"
                  DTS:EventName="OnPostExecute"
                  DTS:LocaleID="-1">
                  <DTS:Variables>
                    <DTS:Variable
                      DTS:CreationName=""
                      DTS:Description="The propagate property of the event"
                      DTS:DTSID="{9E9AC427-C20F-4D80-B6E8-048D6899CA7A}"
                      DTS:IncludeInDebugDump="6789"
                      DTS:Namespace="System"
                      DTS:ObjectName="Propagate">
                      <DTS:VariableValue
                        DTS:DataType="11">-1</DTS:VariableValue>
                    </DTS:Variable>
                  </DTS:Variables>
                  <DTS:Executables>
                    <DTS:Executable
                      DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]\Update Process Status"
                      DTS:CreationName="Microsoft.ExecuteSQLTask"
                      DTS:DelayValidation="True"
                      DTS:Description="Execute SQL Task"
                      DTS:DTSID="{F7DBE720-CF0C-4D35-B6E1-94C728495676}"
                      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                      DTS:LocaleID="-1"
                      DTS:ObjectName="Update Process Status"
                      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
                      <DTS:Variables />
                      <DTS:PropertyExpression
                        DTS:Name="Disable">@[User::OnError] ==1? True: False</DTS:PropertyExpression>
                      <DTS:ObjectData>
                        <SQLTask:SqlTaskData
                          SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                          SQLTask:SqlStatementSource="DECLARE  @ProcessAuditId INT=?&#xA;  ,@DataExtractTypeId INT=?;&#xA;&#xA;-- Update Process Status Only if is incremental of Full load was successful&#xA;IF @DataExtractTypeId = 0&#xA;BEGIN&#xA; UPDATE [adm].[ProcessAudit]&#xA; SET  [Status] = 'U'&#xA;  ,[LastUpdateDate] = GETDATE()&#xA;  ,[LastChangeDate] = GETDATE()&#xA; WHERE [ProcessAuditId] = @ProcessAuditId&#xA;END" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="0"
                            SQLTask:DtsVariableName="User::ProcessAuditId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                          <SQLTask:ParameterBinding
                            SQLTask:ParameterName="1"
                            SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                            SQLTask:ParameterDirection="Input"
                            SQLTask:DataType="3"
                            SQLTask:ParameterSize="-1" />
                        </SQLTask:SqlTaskData>
                      </DTS:ObjectData>
                    </DTS:Executable>
                  </DTS:Executables>
                </DTS:EventHandler>
              </DTS:EventHandlers>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;  ,@ProcessId INT = ?&#xA;  ,@TargetNameExtension VARCHAR(100) = ''&#xA;  ,@SwitchOut INT = 0&#xA;  ,@returnstatus INT;&#xA;  &#xA;-- Create index to match target table  &#xA;EXEC adm.Etl_CreateUnpartitionedTableIndexes @CustomerId,@ProcessId,@returnstatus = @returnstatus OUTPUT;&#xA;&#xA;-- Switch in partition if indexes succesfully created.&#xA;IF @returnstatus = 0&#xA;EXEC adm.Etl_SwitchUnpartitionedTable @CustomerId,@ProcessId,@TargetNameExtension,@SwitchOut,@returnstatus = @returnstatus OUTPUT;&#xA;SELECT @returnstatus;"
                  SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::OnError" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="User::ProcessId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint]"
              DTS:CreationName=""
              DTS:DTSID="{82C510FB-DF5E-4626-8799-DC2CE667BF8B}"
              DTS:From="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint"
              DTS:To="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 1]"
              DTS:CreationName=""
              DTS:DTSID="{619BE3C7-07B9-491F-A16B-F91A4F363784}"
              DTS:From="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 1"
              DTS:To="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 3]"
              DTS:CreationName=""
              DTS:DTSID="{74D59BCE-2471-4D14-AEC0-EEC5909EF49C}"
              DTS:From="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 3"
              DTS:To="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget" />
          </DTS:PrecedenceConstraints>
          <DTS:EventHandlers>
            <DTS:EventHandler
              DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]"
              DTS:CreationName="OnError"
              DTS:DTSID="{732723EF-30E7-4E1C-8965-81CBC831CA3E}"
              DTS:EventID="232316140"
              DTS:EventName="OnError"
              DTS:LocaleID="-1">
              <DTS:Variables>
                <DTS:Variable
                  DTS:CreationName=""
                  DTS:Description="The propagate property of the event"
                  DTS:DTSID="{57A55E1D-7011-4057-AB70-E69573A451E9}"
                  DTS:IncludeInDebugDump="6789"
                  DTS:Namespace="System"
                  DTS:ObjectName="Propagate">
                  <DTS:VariableValue
                    DTS:DataType="11">-1</DTS:VariableValue>
                </DTS:Variable>
              </DTS:Variables>
              <DTS:Executables>
                <DTS:Executable
                  DTS:refId="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]\Update Error Variable"
                  DTS:CreationName="Microsoft.ExecuteSQLTask"
                  DTS:Description="Execute SQL Task"
                  DTS:DTSID="{1CDD3A64-FC73-4CEF-9D79-432218BAD8D0}"
                  DTS:ExecutableType="Microsoft.ExecuteSQLTask"
                  DTS:LocaleID="-1"
                  DTS:ObjectName="Update Error Variable">
                  <DTS:Variables />
                  <DTS:ObjectData>
                    <SQLTask:SqlTaskData
                      SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                      SQLTask:SqlStatementSource="SELECT 1 AS OnError"
                      SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                      <SQLTask:ResultBinding
                        SQLTask:ResultName="0"
                        SQLTask:DtsVariableName="User::OnError" />
                    </SQLTask:SqlTaskData>
                  </DTS:ObjectData>
                </DTS:Executable>
              </DTS:Executables>
            </DTS:EventHandler>
          </DTS:EventHandlers>
          <DTS:ForEachVariableMappings>
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{614282BB-0571-431D-A56F-BD9E45E584FF}"
              DTS:ObjectName="{614282BB-0571-431D-A56F-BD9E45E584FF}"
              DTS:ValueIndex="0"
              DTS:VariableName="User::DataFileName" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{74267AE4-9E0B-42A8-B678-BBFEEFB8B301}"
              DTS:ObjectName="{74267AE4-9E0B-42A8-B678-BBFEEFB8B301}"
              DTS:ValueIndex="1"
              DTS:VariableName="User::TargetTableName" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{79391784-CA37-4215-9788-DBB882DB64EE}"
              DTS:ObjectName="{79391784-CA37-4215-9788-DBB882DB64EE}"
              DTS:ValueIndex="2"
              DTS:VariableName="User::ProcessId" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{10DB5BBF-69A6-4EA9-A053-B19C90996688}"
              DTS:ObjectName="{10DB5BBF-69A6-4EA9-A053-B19C90996688}"
              DTS:ValueIndex="3"
              DTS:VariableName="User::IsSnapshot" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{F0ADF5EA-2EA3-4C67-981A-D87258395BF6}"
              DTS:ObjectName="{F0ADF5EA-2EA3-4C67-981A-D87258395BF6}"
              DTS:ValueIndex="4"
              DTS:VariableName="User::RowCountControl" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{C4465E4B-EFAD-4197-B3DB-BEE27EFBB080}"
              DTS:ObjectName="{C4465E4B-EFAD-4197-B3DB-BEE27EFBB080}"
              DTS:ValueIndex="5"
              DTS:VariableName="User::TotalRecordsInSource" />
            <DTS:ForEachVariableMapping
              DTS:CreationName=""
              DTS:DTSID="{2042DC4B-60BF-4268-A6BF-1CECE8FAE0C1}"
              DTS:ObjectName="{2042DC4B-60BF-4268-A6BF-1CECE8FAE0C1}"
              DTS:ValueIndex="6"
              DTS:VariableName="User::ProductKey" />
          </DTS:ForEachVariableMappings>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:EventHandlers>
        <DTS:EventHandler
          DTS:refId="Package\Process LoadGroup 3.EventHandlers[OnPreExecute]"
          DTS:CreationName="OnPreExecute"
          DTS:DTSID="{BE30E529-40D3-4743-BED4-1FC58E2A3482}"
          DTS:EventID="0"
          DTS:EventName="OnPreExecute"
          DTS:LocaleID="-1">
          <DTS:Variables>
            <DTS:Variable
              DTS:CreationName=""
              DTS:Description="The propagate property of the event"
              DTS:DTSID="{4C25F8C1-A49A-4701-AE60-C6A4D5D43A79}"
              DTS:IncludeInDebugDump="6789"
              DTS:Namespace="System"
              DTS:ObjectName="Propagate">
              <DTS:VariableValue
                DTS:DataType="11">-1</DTS:VariableValue>
            </DTS:Variable>
          </DTS:Variables>
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Process LoadGroup 3.EventHandlers[OnPreExecute]\Get List of Tables to Load"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:DelayValidation="True"
              DTS:Description="Execute SQL Task"
              DTS:Disabled="True"
              DTS:DTSID="{9E46BC0E-BD6A-4EBF-B5D0-436CB9D50D66}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Get List of Tables to Load"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:PropertyExpression
                DTS:Name="Disable">@[System::SourceName]!="Process LoadGroup 3"</DTS:PropertyExpression>
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
                  SQLTask:SqlStatementSource="DECLARE  @CustomerId INT = ?&#xA;  ,@CustomerDatabase VARCHAR(100)=?&#xA;  ,@LoadGroup INT = ?&#xA;  ,@SnapshotDate VARCHAR(50) = ?;&#xA;&#xA;SELECT  DISTINCT&#xA;&#x9; F.DataFileName&#xA;&#x9;,F.TargetTableName&#xA;&#x9;,P.ProcessId&#xA;&#x9;,P.IsSnapshot&#xA;&#x9;,F.RowsExtracted&#xA;&#x9;,F.TotalRowCount&#xA;&#x9;,P.ProductKey&#xA; &#xA;FROM stg.ETL_ControlFiles F &#xA;INNER JOIN adm.Process P ON P.TargetTableName = F.TargetTableName&#xA; AND P.IsActive = 1&#xA; AND F.SnapshotDate = @SnapshotDate&#xA;LEFT OUTER JOIN adm.PostingGroupAudit PGA &#xA; ON PGA.SnapshotCreateDate = F.SnapshotDate&#xA; AND PGA.CustomerId = @CustomerId&#xA;-- Used to exclude completed processes and or Data already in target but still hidden&#xA;LEFT OUTER JOIN adm.ProcessAudit PA&#xA; ON PA.PostingGroupAuditId = PGA.PostingGroupAuditId&#xA; AND PA.ProcessId = P.ProcessId&#xA; AND PA.Status IN ('FI','I','U')&#xA; &#xA;WHERE PGA.Status &lt;&gt; 'FI'&#xA;AND F.DataFileName LIKE '%'+@CustomerDatabase+'%'&#xA;AND P.LoadGroup = @LoadGroup&#xA;AND PA.ProcessId IS NULL&#xA;&#xA;ORDER BY 3;&#xA;"
                  SQLTask:ResultType="ResultSetType_Rowset" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ResultBinding
                    SQLTask:ResultName="0"
                    SQLTask:DtsVariableName="User::DataFileList" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="$Package::CustomerId"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="$Package::CustomerDatabase"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::LoadGroup"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="$Package::SnapshotDate"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
        </DTS:EventHandler>
      </DTS:EventHandlers>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:EventHandlers>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnPostExecute]"
      DTS:CreationName="OnPostExecute"
      DTS:DTSID="{A54993DC-C85F-4A23-AE9D-FDDEDAFD6576}"
      DTS:EventID="98684680"
      DTS:EventName="OnPostExecute"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{6A3A1538-48B1-4231-9AFD-A014335901C5}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnPostExecute]\Update All Processes In Single Transaction"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:Disabled="True"
          DTS:DTSID="{9F367F2D-BF28-4F0C-A64F-38329DEA0FA6}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Update All Processes In Single Transaction"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="Disable">@[System::SourceName] !=  @[System::PackageName]</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
              SQLTask:SqlStatementSource="DECLARE @CustomerId INT=?,&#xA;&#x9;&#x9;@SnapshotDate VARCHAR(50)=?,&#xA;&#x9;&#x9;@OdsPostingGroupAuditId INT=?;&#xA;&#xA;EXEC  adm.Etl_UpdateTargetColumnsWithStaging @CustomerId,@OdsPostingGroupAuditId,@SnapshotDate" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="$Package::CustomerId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="$Package::SnapshotDate"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="2"
                SQLTask:DtsVariableName="User::OdsPostingGroupAuditId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
    </DTS:EventHandler>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnPreExecute]"
      DTS:CreationName="OnPreExecute"
      DTS:DTSID="{7AC235F1-B184-4967-A72C-A6194E5B6D97}"
      DTS:EventID="253369764"
      DTS:EventName="OnPreExecute"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{A2984BB4-6800-450B-9F66-C194D3B2EBFE}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnPreExecute]\Generate PostingGroupAuditId"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:DelayValidation="True"
          DTS:Description="Execute SQL Task"
          DTS:Disabled="True"
          DTS:DTSID="{F29D6417-A071-4DEA-87D8-A85FED9299ED}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Generate PostingGroupAuditId"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2012; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="Disable">@[System::SourceName] !=  @[System::PackageName]</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{35001090-CA06-4B07-B7DA-FE2A3F9D507D}"
              SQLTask:SqlStatementSource="DECLARE  @OltpPostingGroupAuditId INT=?&#xA;&#x9;&#x9;,@PostingGroupId INT=?&#xA;&#x9;&#x9;,@CustomerId INT=?&#xA;&#x9;&#x9;,@OdsVersion VARCHAR(20)=?&#xA;&#x9;&#x9;,@CoreDBVersionId INT=?&#xA;&#x9;&#x9;,@SnapshotCreateDate VARCHAR(100)=?&#xA;&#x9;&#x9;,@DataExtractTypeId INT=?&#xA;&#x9;&#x9;&#xA;EXEC adm.Etl_GetPostingGroupAuditId @OltpPostingGroupAuditId, @PostingGroupId, @CustomerId, @OdsVersion, @CoreDBVersionId, @SnapshotCreateDate, @DataExtractTypeId"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="0"
                SQLTask:DtsVariableName="User::OdsPostingGroupAuditId" />
              <SQLTask:ResultBinding
                SQLTask:ResultName="1"
                SQLTask:DtsVariableName="User::LatestCoreDBVersionId" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="$Package::OltpPostingGroupAudutId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::OdsPostingGroupId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="2"
                SQLTask:DtsVariableName="$Package::CustomerId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="3"
                SQLTask:DtsVariableName="$Package::OdsVersion"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="4"
                SQLTask:DtsVariableName="$Package::CoreDBVersionId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="5"
                SQLTask:DtsVariableName="$Package::SnapshotDate"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="129"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="6"
                SQLTask:DtsVariableName="$Package::DataExtractTypeId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
    </DTS:EventHandler>
  </DTS:EventHandlers>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="32" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="230,43"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
          TopLeft="19,16" />
        <NodeLayout
          Size="255,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
          TopLeft="9,150" />
        <NodeLayout
          Size="243,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
          TopLeft="10,83" />
        <NodeLayout
          Size="234,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn"
          TopLeft="18,219" />
        <EdgeLayout
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint]"
          TopLeft="132.75,59">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,24"
              Start="0,0"
              End="0,16.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 1]"
          TopLeft="135.75,192">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,27"
              Start="0,0"
              End="0,19.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 3]"
          TopLeft="134,125">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,25"
              Start="0,0"
              End="0,17.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,17.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="322,316"
          Size="322,359"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container"
          TopLeft="8.5,13.722222222222" />
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="336,428"
          Size="336,471"
          Id="Package\Process LoadGroup 1"
          TopLeft="30,16.3333333333342" />
        <NodeLayout
          Size="230,43"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
          TopLeft="19,16" />
        <NodeLayout
          Size="248,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
          TopLeft="9,150" />
        <NodeLayout
          Size="243,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
          TopLeft="10,83" />
        <NodeLayout
          Size="234,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn"
          TopLeft="18,219" />
        <EdgeLayout
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint]"
          TopLeft="132.75,59">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,24"
              Start="0,0"
              End="0,16.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 1]"
          TopLeft="134,192">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,27"
              Start="0,0"
              End="0,19.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 3]"
          TopLeft="132.25,125">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,25"
              Start="0,0"
              End="0,17.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,17.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="333,316"
          Size="333,359"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container"
          TopLeft="8.5,14.6249999955156" />
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="346,428"
          Size="346,471"
          Id="Package\Process LoadGroup 2"
          TopLeft="427,16" />
        <NodeLayout
          Size="230,43"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging"
          TopLeft="19,16" />
        <NodeLayout
          Size="248,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget"
          TopLeft="9,150" />
        <NodeLayout
          Size="243,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes"
          TopLeft="10,83" />
        <NodeLayout
          Size="234,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn"
          TopLeft="18,219" />
        <EdgeLayout
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint]"
          TopLeft="132.75,59">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,24"
              Start="0,0"
              End="0,16.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 1]"
          TopLeft="134,192">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,27"
              Start="0,0"
              End="0,19.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,19.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.PrecedenceConstraints[Constraint 3]"
          TopLeft="132.25,125">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,25"
              Start="0,0"
              End="0,17.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,17.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="322,316"
          Size="322,359"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container"
          TopLeft="8.5,13.722222222222" />
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="336,428"
          Size="336,471"
          Id="Package\Process LoadGroup 3"
          TopLeft="830,14" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <DtsEventHandler
    design-time-name="Package.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="280.5,42"
          Id="Package.EventHandlers[OnPostExecute]\Update All Processes In Single Transaction"
          TopLeft="5.5,5.5" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="NaN,NaN"
          Id="Package.EventHandlers[OnPreExecute]\Generate PostingGroupAuditId"
          TopLeft="NaN,NaN" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 1.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="198.5,42"
          Id="Package\Process LoadGroup 1.EventHandlers[OnPreExecute]\Get List of Tables to Load"
          TopLeft="5.5,5.5" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="180.5,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]\Update Error Variable"
          TopLeft="24.5,24.5" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="202,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId"
          TopLeft="63,241" />
        <NodeLayout
          Size="180.5,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
          TopLeft="71.5,117.5" />
        <EdgeLayout
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint]"
          TopLeft="162.875,159.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,81.5"
              Start="0,0"
              End="0,74">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,74" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="191,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="NaN,NaN" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="191,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="NaN,NaN" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="191,42"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="NaN,NaN" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="NaN,NaN"
          Id="Package\Process LoadGroup 1\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="NaN,NaN" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 2.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="204,42"
          Id="Package\Process LoadGroup 2.EventHandlers[OnPreExecute]\Get List of Tables to Load"
          TopLeft="NaN,NaN" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="180.5,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]\Update Error Variable"
          TopLeft="42.5,32" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="202,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId"
          TopLeft="44,212" />
        <NodeLayout
          Size="180.5,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
          TopLeft="40.5,73" />
        <EdgeLayout
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint]"
          TopLeft="130.75,115">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="14.25,97"
              Start="0,0"
              End="14.25,89.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,44.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,44.5"
                    Point2="0,48.5"
                    Point3="4,48.5" />
                  <mssgle:LineSegment
                    End="10.25,48.5" />
                  <mssgle:CubicBezierSegment
                    Point1="10.25,48.5"
                    Point2="14.25,48.5"
                    Point3="14.25,52.5" />
                  <mssgle:LineSegment
                    End="14.25,89.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="143,93" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="32,26" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="29,18" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 2\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="29,18" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 3.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="202,42"
          Id="Package\Process LoadGroup 3.EventHandlers[OnPreExecute]\Get List of Tables to Load"
          TopLeft="NaN,NaN" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="180.5,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container.EventHandlers[OnError]\Update Error Variable"
          TopLeft="15.5,25" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="202,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Generate ProcessAuditId"
          TopLeft="60.5,248.5" />
        <NodeLayout
          Size="180.5,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute]\Update Error Variable"
          TopLeft="62.5,79.5" />
        <EdgeLayout
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPreExecute].PrecedenceConstraints[Constraint]"
          TopLeft="152.75,121.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="8.75,127"
              Start="0,0"
              End="8.75,119.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,59.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,59.5"
                    Point2="0,63.5"
                    Point3="4,63.5" />
                  <mssgle:LineSegment
                    End="4.75,63.5" />
                  <mssgle:CubicBezierSegment
                    Point1="4.75,63.5"
                    Point2="8.75,63.5"
                    Point3="8.75,67.5" />
                  <mssgle:LineSegment
                    End="8.75,119.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\BulkInsertIntoStaging.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="143,93" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\InsertRecordsFromStagingToTarget.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="32,26" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\ReduceStagingDataWithHashbytes.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="29,18" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <DtsEventHandler
    design-time-name="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="186,42"
          Id="Package\Process LoadGroup 3\Foreach Table in PostingGroup Loop Container\SwitchPartitionIn.EventHandlers[OnPostExecute]\Update Process Status"
          TopLeft="29,18" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>